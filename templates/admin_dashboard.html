<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="static/inss-logo.ico" />

    <title>SINGED INSS - Painel Administrativo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="/static/style.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script>
       $(function () {
          $("#header").load("../static/header.html");
          $("#footer").load("../static/footer.html");
       });
    </script>
</head>
<body>

    <div class="container">
        <div id="header"></div>
    </div>
    
    <div class="container">
        <div class="admin-container">
            <h2 style="color: #0047a5;">Painel Administrativo</h2>
            
            <div class="admin-sections">
                
                <!-- Seção Computadores -->
                <h2 style="color: #0047a5; margin-top: 2rem;">Gerenciar Opções - Computadores</h2>
                <div class="admin-sectionsub">    
                <div class="admin-section">
                    <h3>Gerenciar Marcas</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Marcas Atuais:</h4>
                            <ul id="marcas-list">
                                {% for marca in marcas %}
                                <li>
                                    {{ marca }}
                                    <button class="btn-delete" onclick="deleteValue('marcas', '{{ marca }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="nova-marca" placeholder="Nova marca">
                            <button class="button" onclick="addValue('marcas')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Modelos</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Modelos Atuais:</h4>
                            <ul id="modelos-pc-list">
                                {% for modelo in modelos_pc %}
                                <li>
                                    {{ modelo }}
                                    <button class="btn-delete" onclick="deleteValue('modelos_pc', '{{ modelo }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-modelo-pc" placeholder="Novo modelo">
                            <button class="button" onclick="addValue('modelos_pc')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Tipos de Dispositivo</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Tipos Atuais:</h4>
                            <ul id="tipos-list">
                                {% for tipo in tipos %}
                                <li>
                                    {{ tipo }}
                                    <button class="btn-delete" onclick="deleteValue('tipos_dispositivo', '{{ tipo }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-tipo" placeholder="Novo tipo">
                            <button class="button" onclick="addValue('tipos_dispositivo')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Tipos de Armazenamento</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Tipos Atuais:</h4>
                            <ul id="armazenamento-list">
                                {% for tipo in armazenamento %}
                                <li>
                                    {{ tipo }}
                                    <button class="btn-delete" onclick="deleteValue('tipos_armazenamento', '{{ tipo }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-armazenamento" placeholder="Novo tipo">
                            <button class="button" onclick="addValue('tipos_armazenamento')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Quantidades de RAM</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Quantidades Atuais:</h4>
                            <ul id="ram-list">
                                {% for qtd in quantidades_ram %}
                                <li>
                                    {{ qtd }} GB
                                    <button class="btn-delete" onclick="deleteValue('quantidades_ram', '{{ qtd }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="number" id="nova-ram" placeholder="Nova quantidade">
                            <button class="button" onclick="addValue('quantidades_ram')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Quantidades de Armazenamento</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Quantidades Atuais:</h4>
                            <ul id="armazenamento-qtd-list">
                                {% for qtd in quantidades_armazenamento %}
                                <li>
                                    {{ qtd }} GB
                                    <button class="btn-delete" onclick="deleteValue('quantidades_armazenamento', '{{ qtd }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="number" id="nova-armazenamento-qtd" placeholder="Nova quantidade">
                            <button class="button" onclick="addValue('quantidades_armazenamento')">Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>    
            
            <!-- Seção Outros Dispositivos -->
            <h2 style="color: #0047a5; margin-top: 2rem;">Gerenciar Opções - Outros Dispositivos</h2>
            <div class="admin-sectionsub">
                <div class="admin-section">
                    <h3>Gerenciar Marcas</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Marcas Atuais:</h4>
                            <ul id="marcas-outros-list">
                                {% for marca in marcas_outros %}
                                <li>
                                    {{ marca }}
                                    <button class="btn-delete" onclick="deleteValue('marcas_outros', '{{ marca }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="nova-marca-outros" placeholder="Nova marca">
                            <button class="button" onclick="addValue('marcas_outros')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Modelos</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Modelos Atuais:</h4>
                            <ul id="modelos-outros-list">
                                {% for modelo in modelo_outros %}
                                <li>
                                    {{ modelo }}
                                    <button class="btn-delete" onclick="deleteValue('modelo_outros', '{{ modelo }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-modelo-outros" placeholder="Novo modelo">
                            <button class="button" onclick="addValue('modelo_outros')">Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>Gerenciar Tipos de Dispositivo</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Tipos Atuais:</h4>
                            <ul id="tipos-outros-list">
                                {% for tipo in tipos_outros %}
                                <li>
                                    {{ tipo }}
                                    <button class="btn-delete" onclick="deleteValue('tipos_outros', '{{ tipo }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-tipo-outros" placeholder="Novo tipo">
                            <button class="button" onclick="addValue('tipos_outros')">Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Seção Campos Globais -->
            <h2 style="color: #0047a5; margin-top: 2rem;">Campos Globais</h2>
            <div class="admin-sectionsub">
                <div class="admin-section">
                    <h3>Gerenciar Estagiários</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Estagiários Atuais:</h4>
                            <ul id="estagiarios-list">
                                {% for estagiario in estagiarios %}
                                <li>
                                    {{ estagiario }}
                                    <button class="btn-delete" onclick="deleteValue('estagiarios', '{{ estagiario }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-estagiario" placeholder="Novo estagiário">
                            <button class="button" onclick="addValue('estagiarios')">Adicionar</button>
                        </div>
                    </div>
                </div>
                <div class="admin-section">
                    <h3>Gerenciar Opções de Funcionamento</h3>
                    <div class="field-management">
                        <div class="current-values">
                            <h4>Opções Atuais:</h4>
                            <ul id="funcionando-list">
                                {% for func in funcionando %}
                                <li>
                                    {{ func }}
                                    <button class="btn-delete" onclick="deleteValue('funcionando', '{{ func }}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="add-value">
                            <input type="text" id="novo-funcionando" placeholder="Nova opção (ex: Sim, Não)">
                            <button class="button" onclick="addValue('funcionando')">Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

    
    </div>
 
    <div class="container"><div id="footer"></div></div>
    <script>
        async function addValue(field) {
            let inputId;
            switch (field) {
                case 'marcas':
                    inputId = 'nova-marca';
                    break;
                case 'modelos_pc':
                    inputId = 'novo-modelo-pc';
                    break;
                case 'tipos_dispositivo':
                    inputId = 'novo-tipo';
                    break;
                case 'tipos_armazenamento':
                    inputId = 'novo-armazenamento';
                    break;
                case 'quantidades_ram':
                    inputId = 'nova-ram';
                    break;
                case 'quantidades_armazenamento':
                    inputId = 'nova-armazenamento-qtd';
                    break;
                case 'marcas_outros':
                    inputId = 'nova-marca-outros';
                    break;
                case 'modelo_outros':
                    inputId = 'novo-modelo-outros';
                    break;
                case 'tipos_outros':
                    inputId = 'novo-tipo-outros';
                    break;
                case 'estagiarios':
                    inputId = 'novo-estagiario';
                    break;
                case 'funcionando':
                    inputId = 'novo-funcionando';
                    break;
                default:
                    alert('Tipo de campo inválido');
                    return;
            }

            const value = document.getElementById(inputId).value;
            if (!value) {
                alert('Por favor, preencha o campo');
                return;
            }

            try {
                const response = await fetch(`/admin/options/${field}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ value: value })
                });

                const data = await response.json();

                if (response.ok) {
                    location.reload();
                } else {
                    alert(data.detail || 'Erro ao adicionar valor');
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao adicionar valor');
            }
        }

        async function deleteValue(field, value) {
            if (!confirm('Tem certeza que deseja excluir este valor?')) return;

            try {
                const response = await fetch(`/admin/options/${field}/${encodeURIComponent(value)}`, {
                    method: 'DELETE'
                });

                const data = await response.json();

                if (response.ok) {
                    location.reload();
                } else {
                    alert(data.detail || 'Erro ao excluir valor');
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao excluir valor');
            }
        }
    </script>
</body>
</html>